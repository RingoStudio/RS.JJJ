# JJJ V2

## 更新内容
### 2024.11.9 JJJ更新内容
1. 增加"查询微信群总览"指令，可查询微信群内成员与俱乐部成员之间的绑定关系。
2. 增加"设置北极贝需要买卷轴 开/关" 指令，若设置为开，该俱乐部未使用白蝌蚪购买卷轴的成员将会被提醒或标出。
3. 修复北极贝历史数据缺失。
4. 每次启动JJJ时，清空OUT文件夹下三天前的文件。
5. 完善权限缓存，配置会长、经理、成员时清空相应缓存。

### 2024.11.10 JJJ更新内容
1. 统一自动登录时间，周四最后一次改为22:00，其他日期最后一次改为20:00。
2. 增加"自动登录配置表"以及"上传自动配置表"命令，通过使用这两个命令，用户可以通过填写和上传一个excel表格实现自动登录时间及自动提醒内容的自定义。
   2.1 未进行唧唧叽自动登录设置表的俱乐部，可以继续按照原有设定进行"设置自动登录/设置自动提醒/设置自动提醒物种历史等。
   2.2 进行过唧唧叽自动登录设置表配置的俱乐部中，"设置自动登录" 将启动和取消所有配置表内的登录时间点；"设置自动提醒/设置自动提醒物种历史/设置自动提醒挖矿/设置自动提醒金银牌"指令将只影响手动登录后的自动提醒，自动登录的提醒需要使用"设置自动登录配置"提交本表进行具体配置。
   2.3 通过发送"查看俱乐部"可快速查看自动登录配置表中的内容。
3. 增强对成员积分清单收包的检测，降低出现部分成员金银牌和挖矿不准的概率。
4. 修复当"设置登录提示会长"设置为关时，依然在自动提醒时at会长的问题。
5. 修正把"北极贝卷轴没用完"写成"蜣螂没打"的问题，并且把代表北极贝的emoji由牡蛎改为海螺。

### 2024.11.11 JJJ更新内容
1. 修正"查询挖矿到期"指令中后面跟随时间参数无效的问题，该时间是指查询所有给定时间内到期的矿，不填为默认0.5小时，例如"查询挖矿到期 8"。
2. 修正用户反馈"如果群里一个人绑定了多个游戏角色 其中一个角色没有完成任务的时候 每次都会提醒@xxx（所有角色）"的问题。按照设计，当一个人绑定了一个角色时，只at不显示昵称，当一个人绑定多个角色时，如果所有角色都未完成相应任务，则提醒@xxx（所有角色）,如果不是所有角色都未完成，则提醒@xxx（角色1， 角色2， ...）。
3. 修复唧唧叽ai对话中无法正确响应对话内容的问题。

### 2024.11.17凌晨 JJJ更新内容
1. 修正仓鼠历史"仓鼠领取补给时间"计算错误，及其导致的"查询物种历史"、"提醒物种历史"中相关的错误。
2. 修正"物种总览"中"仓鼠拍卖地块"显示错误的问题。
3. 周五期间，"看看矿"和"我的矿"不再显示查询结果。
4. 修正"求签"和"解签"冷却时间大于1天的问题。
5. 登录过程中发生不可挽救的错误(例如"账号在别处登录"等)时，不再重试登录。
6. 登录结束后将提示离开本俱乐部和新加入本俱乐部的成员名单，此提示可通过"设置提醒俱乐部成员变动"命令打开或关闭。

### 2024.11.17午间 JJJ更新内容
1. 修复仓鼠拍卖相关数据计算错误，及其导致的"查询仓鼠拍卖总览"以及"设置仓鼠拍卖地块"失败的问题。
2. 修复因俱乐部总战力数值溢出导致"查询仓鼠拍卖总览"生成失败的问题。
3. 修复"拍哪里"无法查询的问题。

### 2024.11.17下午 JJJ更新内容
1. 增加"贵重"图鉴查询功能，可查询贵重品一图流，具体使用方法为：
   1.1 发送"贵重 名称"，例如"贵重 黄金蜗牛雕像"，或"贵重 黄金蜗牛"(模糊搜索)可查询具体贵重。
   1.2 发送"贵重 品阶 类型 光环名称 镶嵌名称 来源名称 其他搜索字符"，例如"贵重 SSS 人气 光环领导力 镶嵌探索罗盘 来源周年庆 黄金蜗牛"可多条件联合搜索。需要注意的是，"光环"、"镶嵌"、"来源"三项一定要在查询命令中写出来。
2. 增加"今日贵重"图鉴查询功能，可查询今日贵重品一图流。

### 2024.11.18凌晨 JJJ更新内容
1. 优化贵重图鉴查询，当查询结果由多个，且其中包含一个要查询的贵重名称时，也将发出该贵重品一图流，例如查询"贵重 圣杯"时，将找到"圣杯"和"火焰圣杯"两个贵重品，此时唧唧叽还将发出"圣杯"的一图流。
2. 修复"查询仓鼠拍卖总览"-"拍卖地块"-"总参与人数"的显示问题。
3. 增加"设置提醒钻头下限"命令，格式为"设置提醒钻头下限 [可选:RID] [数量]"，通过此命令进行设置后，例如"设置提醒钻头下限 50"时："周四清资源"及任意时刻"提醒钻头"中将不再提醒剩余钻头低于50个的成员。此项设置与"提醒钻头"后面的数量参数不冲突，两个数字中最大的生效。
4. 增加"设置钻头达标数量"命令，格式为"设置钻头达标数量 [可选:RID] [数量1] [数量2]"，其中两个数量中较大一个设置给勘探，较小一个设置给敢死和苦力，如果只填一个数量，那么将会给三个套装设置相同的达标数量，如果不填，则达标数量清零。若达标数量为0，则表示当前俱乐部对钻头达标数量不做要求。

### 2024.11.21 19:00 JJJ更新内容
1. 优化微信消息合并逻辑，现可合并发出@消息，并且可以连续发出不多于9个文件或图片。
2. 贵重搜索支持"光环重伤率"查询。

### 2024.11.30 18:40 JJJ更新内容
1. 修复周六蜣螂历史未参与的成员不被识别的问题（需重新登录以刷新数据）。
2. 修复"查询领错套装"命令无法正常查询的问题。
3. 修复登录后提示退出俱乐部成员显示异常的问题。 

### 2024.12.06 18:46 JJJ更新内容
1. 增加了守护跳姐功能。
2. 修复了由dis文件缓存导致的ios服登录时提示"更新客户端"的问题。
3. 广播可发送APP卡片。
4. 发送广播指令时可不跟文本内容，以便直接群发附件。

### 2024.12.08 17:35 JJJ更新内容
1. 修复了由于区服模块（ServerDistM）初始化问题导致的登录失败。

### 2025.01.13 15:00 JJJ更新内容
1. 在"查询物种总览"表格中增加"本周活跃度"、"游戏时长"、"基因强度"三列，以满足部分俱乐部管理需要。
2. 在所有合并提醒发出时，每个at的微信名称后面都增加标注对应的游戏角色名称。
3. 增加"提醒钻头达标"命令，俱乐部进行了"设置钻头达标数量"配置后，发送此指令可立即提醒每个使用钻头数量未达标的俱乐部成员。

### 2025.01.16 13:25 JJJ更新内容
1. 适配微信版本V3.9.11.25。
2. 在"我的矿"和"看看矿"的查询内容中增加到期时间显示，例如"➡️周四18:30"。

### 2025.02.28 21:37 JJJ更新内容
1. 增加"设置仓鼠需要参加拍卖 开/关" 指令，若设置为开，该俱乐部未参与仓鼠拍卖成员将会被提醒或标出。
2. 修复部分微信群"刷新群信息"无效的问题。

### 2025.03.01 15:00 JJJ更新内容
1. 优化"我的矿"查询结果显示格式。

### 2025.03.08 23:00 JJJ更新内容
1. 适配WCF版本v3.9.4.1, 微信版本V3.9.12.17，性能更佳。
2. 将"更新对话"中接收到的文件另存到"USER\CACHE"路径中，防止被微信自行清理。
3. 将OSSHelper中硬编码的OSS密钥放在BOT\oss.ini文件中，防止在github中泄密。
4. 整理BOT路径下的存档文件：
[NEW]
BOT\oss.ini

[MIGRATE]
BOT\cdkey2.res -> USER\DATA\cdkey2.res
BOT\conversation.res -> USER\DATA\conversation.res
BOT\device_info_android.res -> USER\DATA\device_info_android.res
BOT\device_info_ios.res -> USER\DATA\device_info_ios.res
BOT\dislists.res -> USER\DATA\dislists.res
BOT\mayday.res -> USER\DATA\mayday.res
BOT\qcsdk_tokens.res -> USER\DATA\qcsdk_tokens.res
BOT\qian_cache.res -> USER\DATA\qian_cache.res
BOT\questionnaire.res -> USER\DATA\questionnaire.res

BOT\club_data.res -> USER\CLUB\club_data.res
BOT\club_members.res -> USER\CLUB\club_members.res
BOT\group_data.res -> USER\CLUB\group_data.res
BOT\gw_events.res -> USER\CLUB\gw_events.res
BOT\role_cache.res -> USER\CLUB\role_cache.res
BOT\user_data.res -> USER\CLUB\user_data.res

BOT\visitor.res -> RES\CSV\visitor.res
BOT\zhouyi64.res -> RES\CSV\zhouyi64.res
BOT\qian.txt -> RES\CSV\qian.txt

BOT\jjj_instruction_simple_cover.png -> IMG\jjj\jjj_instruction_simple_cover.png
BOT\jjj_instruction_cover2.png -> IMG\jjj\jjj_instruction_cover2.png
BOT\jjj_instruction_cover.png -> IMG\jjj\jjj_instruction_cover.png
BOT\gw_kit.png -> IMG\jjj\gw_kit.png
BOT\gw_event_sum_list.png -> IMG\jjj\gw_event_sum_list.png
BOT\gw_event_multi_list.png -> IMG\jjj\gw_event_multi_list.png
BOT\gw_event_mine_list.png -> IMG\jjj\gw_event_mine_list.png
BOT\gw_event_boss_list.png -> IMG\jjj\gw_event_boss_list.png